
# 一个极简的系统引导

## 加电启动

BIOS -- MBR --- KERNEL

计算机在刚加电启动时，RAM 中是空的，没有可执行的程序。那第一步要做什么呢？
运行BIOS

BIOS 是如何被运行的？
x86 CPU 加电后首先进入16位实模式，16位模式下的寻址方式：

加电瞬间， CS 的值是 0xF000

BIOS 被加载到哪里  


BIOS 加载中断向量表和中断程序




## MBR 如何运行起来

mbr 调用 BIOS 的代码


应用程序（用户态）如何调用内核的代码？




## 问题引出
段错误的原理？  
系统调用的实现？  
swap 相关的内存管理  
硬中断、软中断？ 




在实模式下，可以访问 1M 的内存空间，但这 1M 的空间，并不是全部都是 DRAM, 以下是空间分布：


在 x86 系统中，将 1M 空间最上面的 0xF0000 到 0xFFFFF 这 64K 映射给 ROM， ROM 中固化了初始化程序，就是平时说的 BIOS。计算机在加电后，CS 的值是 0xF000， IP 的值为 0xFFF0, 

### BIOS 做了什么？
检查硬件：如检查内存
创建中断向量表和中断服务例程：键盘、鼠标  
加载 MBR

### MBR
我们的系统，一般是存储在硬盘上，当计算机被配置为从磁盘启动时，BIOS 会将磁盘的第一个扇区的内容加载到 0x0000:0x7c00， 然后 jmp

如何校验 MBR?  
在 MBR 上读磁盘？  


[从零开始写 OS 内核 -](https://segmentfault.com/a/1190000040131294)  
[使用 C 语言编写运行于16位实模式下的代码](https://segmentfault.com/a/1190000040131294)   
[实模式C语言MBR程序](https://i-m.dev/posts/20180124-234628.html)  


假设磁盘上保存了一个操作系统，如何加载这个系统呢？
### 在实模式下加载程序并运行


### 在保护模式下加载程序并运行


